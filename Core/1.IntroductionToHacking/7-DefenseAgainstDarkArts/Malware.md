As we went over earlier, if a sufficiently advanced attacker wants to get into your stuff specifically, they will.

But we have looked at our threat model before and have determined we are probably not a person of interest to the NSA/Mossad/FSB, right? Right???

So according to our threat model, the most likely people to hack us will be random criminals who don't care who we are, they're just trying to get in. While it is an over simplification, "An ounce of prevention is worth a pound of cure". If you are able to harden yourself ahead of time and not be an easy target, you will be much less likely to get hit with a non-targeted attack, and in the possibility that you ever are targeted, you will be more likely to not get caught off guard.

These are all of the reasons you might get hacked.
# You are already hacked!! 

This is a very common method of getting more malware on your computer, already having others. Seriously, as I am writing this, I ran a scan on this shared computer I am using and removed 5 separate PUPs and 1 piece of adware. Shared computers, whether family, work, or libraries, are hot places for malware to be sitting on, and if you log in to a owned computer, you might just lose your passwords to a keylogger. So let's make sure you are not owned already and then set ourselves up to be safe in the future.

## How Can You Tell
Remember indicators of compromise from before (IOC). There are a ton that can be used, some approaches more technical than others. Common non-techical indicators include constant pop ups, home page redirection, search engine redirection, a bunch of toolbars, and the computer being slow and the fan working way too hard. Technical indicators include extra processes running, network requests, and things saved in places they shouldn't be. Looking for these technical indicators is called "Threat Hunting". It deserves its own section, but we will briefly go over a few ways you can identify the bad things on your computer.

* https://blog.malwarebytes.com/101/2016/05/how-to-tell-if-youre-infected-with-malware/

### Processes 
This is where anti-virus/malware really shines! Basically, these companies break down the malware into tiny pieces and creates indicators for them, so that they can identify them on your computer and completely delete them off. My personal recommendation is Malwarebyte's free offering. Windows Defender is another amazing tool that should be run at all times for protection from emerging threats. There is no need to have any other anti-virus on your computer, more is not better.

Task:
1. Download Malwarebytes and run it. https://www.malwarebytes.com/mwb-download/
2. Install Windows Defender, because it is built into your computer and really, really good. If it is installed, make sure it is running.
3. Uninstall Malwarebytes. You don't need it around all the time, just whenever you get on a new computer and once every couple months.


### Network Requests
If malware is on your network, it is going to try to talk out. There are plenty of ways to look at network traffic but I recommend the tool Glasswire and Wireshark for this purpose. Glasswire identifies processes making network connections and alerts on them. If the process doesn't make sense when it pops up, go to Wireshark and open up the stream to see if it makes sense.

Tasks:
1. Download Glasswire
2. You already should have Wireshark downloaded. If not, download it.
3. Open up ______ and look at the Glasswire alerts.
4. Identify the stream in Wireshark.

# You got tricked!

The most likely scenario is that you ran someone else's code and gave them access to your computer. There's nothing to feel bad about, this could have happened in many ways, and it happens to the best of us. Common ways this could have occured are online installers, phishing, and downloaded tools getting a malicious update. We will go over each method, and how to avoid it in the future. 

## Downloaded Something Nasty

One of the biggest things you can do to avoid getting phished is to learn what a phishing attempt looks like. Read this: https://blog.malwarebytes.com/101/2017/06/somethings-phishy-how-to-detect-phishing-attempts/
Also, read this: https://ssd.eff.org/en/module/how-avoid-phishing-attacks

Now what do you do if someone tries to phish you, or you are wondering if this is a phishing attempt? Read this: https://decentsecurity.com/malware-web-and-phishing-investigation/

If you get a phish, good chance other people are getting it as well. So you need to report it! Make sure you know how to report to your organization to protect everyone else!

You could have also run some backdoored shit, whether from an online download, or packaged in with real software. A good move before downloading anything is run it through these sites listed in the anti-phishing tools. 

Tasks: 
1. Analyze a malicious attachement using a few of the sites
2. Analyze a malicious URL using a few of the sites
3. Analyze an IP using a few of the sites
4. Set UAC to high.

##  Outdated Extensions and Other Things You Have Granted Access To

A long time ago, you might have used a FB addon that made cool faces on your profile picture, or a Chrome calendar extension that allowed you to remember your mom's birthday. Well, now the original coders got bored and sold it to some shit ass criminals who are using it to steal your shit. At one point they were good, now they are bad, and you need to get them off your shit. Most of the time, Malwarebytes can catch extensions on your computer, or Chrome will identify them as bad. But you still gotta get the addons out of your accounts.

Tasks:
1. Check email for devices you have given permissions to
2. Check email for services you have given permissions to
3. Check FB for addons
4. Check Twitter for addons
5. Check any other sites you can think of for addons.


# Someone else got Owned

Your security is only as good as your weakest link. Read these articles about some of the cooler hacks in recent memory and get an idea of what is possible and where each failure was caused by someone else getting owned.

* Home depot hack
  * https://krebsonsecurity.com/2014/02/target-hackers-broke-in-via-hvac-company/
* RSA Keys
  * https://bits.blogs.nytimes.com/2011/04/02/the-rsa-hack-how-they-did-it/
* Bit9 Hack
  * https://krebsonsecurity.com/2013/02/security-firm-bit9-hacked-used-to-spread-malware/
* NotPetya
  * https://blog.talosintelligence.com/2017/07/the-medoc-connection.html
	  




full disclosure, responsible disclosure,.... selling. 



bug bounty program

hackerone account/bugcrowd account




# Well Shit, You Got Hacked.
## How do we fix that?

We are about to get philisophical. Remember how we were just talking about how there is straight up, NO possible way for us to know if your computer is owned? Well we are about to get into the exact same problem, but now for cleaning your computer. If you have evidence that a malicious program ran on your computer, you can never trust this computer ever again. That tiny PUP that kept changing your homepage to some chinese marketplace could have been bundled with some nation state rootkit that overwrote your computer's foundational code down at the soul of the device and you aren't going to be able to remove that malware unless you return the silicon into sand.  

However, that is very, very, very unlikely. As we have said before, you are not going to be targeted by nation states, or really anyone at all. If you get hacked, almost certainly by an untargeted attack, the malware will drop itself off, establish persistence, and then do its thing. While there have been examples in the past of standard malware going for rootkit persistence, that is significantly more difficult on modern operating systems. 99% of the time, if antivirus identifies the malware and removes it, you are good and don't have to worry about any follow on problems. Sure, that does leave room for the next 1%, so my recommendation is remove the malware, let that computer chill for a day or two if you can afford to use another, and then run the malware scan again. If you keep finding malware you have a bigger problem, but the rest of the time, you can just go back to using the computer as normal. It is no life to buy a new computer every time you mess up, and it get's expensive fast.

So with all that said, if you use your computer for nuclear launch codes, critical intellectual property, or managing the crypto wallets of your hoarded wealth in addition to casual internet surfing, don't destroy the pwned computer. Buy a new computer to do your serious business, and then clean up the old one as best you can and use the old computer to surf the web. Compartmentalization is key. 

## So how do I get it clean again? 

Can't do better than this guide. 
https://blog.malwarebytes.com/101/2015/06/10-easy-steps-to-clean-your-infected-computer/
Also, go to a clean computer and change all of your passwords immediately. Allllll of them.

## What would happen if the malware doesn't all get deleted on the first run? 

If all the malware is still there, it means that the anti-virus you're using isn't very good, or that the malware is pretty good. Maybe both. Either way, you are not good enough to go and manually delete everything you need to delete the malware yourself, so best bet is don't use the computer for a few days, then try and delete it again using your tools after their signatures get updated. If the malware's persistence mechanism is so good you still can't beat it, your best move is to reinstall the operating system. This will work in most cases, though there is a small chance of a rootkit/bookit or worse, firmware malware persisting across OS installs. If this happens... get your computer to someone who can get it to the NSA because that's some high quality shit.

## Repeat Attack Vectors

If you removed the malware, but it keeps appearing, and you are confident it isn't persistent, you need to figure it out. 
* Patching
     * If you haven't patched, you are still vulnerable!
* Attachments
     * If you, or someone else keeps getting hit with attachments/etc, they need some user training
* Pirated Software
     * If you keep downloading pirated shit, you will keep getting popped. That is just how it goes.
* Porn Popups 
     * Same shit, stop going on sketchy porn sites and downloading things.
     
# Securing Your Windows Box

Do Taylor Swift's Holiday list and understand what you are doing 
https://decentsecurity.com/holiday-tasks/
https://decentsecurity.com/securing-your-computer/

## Securing Your Ubuntu Box

https://www.codelitt.com/blog/my-first-10-minutes-on-a-server-primer-for-securing-ubuntu/

