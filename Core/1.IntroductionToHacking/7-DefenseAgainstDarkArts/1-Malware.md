As we went over earlier, if a sufficiently advanced attacker wants to get into your stuff specifically, they will.

But we have looked at our threat model before and have determined we are probably not a person of interest to the NSA/Mossad/FSB, right? Right???

So according to our threat model, the most likely people to hack us will be random criminals who don't care who we are, they're just trying to get in. While it is an over simplification, "An ounce of prevention is worth a pound of cure". If you are able to harden yourself ahead of time and not be an easy target, you will be much less likely to get hit with a non-targeted attack, and in the possibility that you ever are targeted, you will be more likely to not get caught off guard.

These are some of the most common of the reasons you might get hacked.
# You are already hacked!! 

The most common way to get malware on your computer is to already have malware on your computer. Seriously, as I was first writing this section, I ran a scan on my shared family computer I am using and removed 5 separate PUPs and 1 piece of adware. Shared computers, whether family, work, or libraries, are hot places for malware to be sitting on, and if you log in to a owned computer, you might just lose your passwords to a keylogger. So let's make sure you are not owned already and then set ourselves up to be safe in the future. 

## How Can You Tell
Remember the term indicators of compromise (IOC) from before?. There are a ton that can be used, some approaches more technical than others. Common non-techical indicators include constant pop ups, home page redirection, search engine redirection, the classic pile of toolbars, and the computer being slow and the fans working way too hard. Technical indicators include extra processes running, network requests, and things saved in places they shouldn't be. Looking for these technical indicators is called "Threat Hunting". It deserves its own section, but we will briefly go over a few ways you can identify the bad things on your computer.

* https://blog.malwarebytes.com/101/2016/05/how-to-tell-if-youre-infected-with-malware/

### Anti-Virus
This is where anti-virus/malware really shines! Basically, these companies execute the malware, break down the malware into tiny pieces and creates indicators for the different components and what the execution of them look like, so that they can identify them on your computer and completely delete them off. My personal recommendation is Malwarebyte's free offering. Windows Defender is another amazing free tool that should be run at all times for protection from emerging threats. There is no need to have any other anti-virus on your computer, more is not better. 

Task:
0. Read this: https://www.howtogeek.com/125650/htg-explains-how-antivirus-software-works
1. Download Malwarebytes and run it. https://www.malwarebytes.com/mwb-download/
2. Install Windows Defender, because it is built into your computer and really, really good. If it is installed, make sure it is running.
3. Uninstall Malwarebytes. You don't need it around all the time, just whenever you get on a new computer and once every couple months.


### Process Hunting 
Read this: [https://resources.infosecinstitute.com/category/enterprise/threat-hunting/threat-hunting-process/](https://resources.infosecinstitute.com/category/enterprise/threat-hunting/threat-hunting-process/) 

Read this. [https://www.rsaconference.com/writable/presentations/file_upload/hta-t07r-license-to-kill-malware-hunting-with-the-sysinternals-tools_final.pdf](https://www.rsaconference.com/writable/presentations/file_upload/hta-t07r-license-to-kill-malware-hunting-with-the-sysinternals-tools_final.pdf)

Now we are going to complete this little tutorial so that you can learn all about Sysinternals! I need to put some time into this, but you will get enough out of this without any extra guidance that it is worthwhile. Using this link, complete all lessons from the site.

[https://www.howtogeek.com/school/sysinternals-pro/lesson1/](https://www.howtogeek.com/school/sysinternals-pro/lesson1/)

1. What Are the SysInternals Tools and How Do You Use Them?
2. Understanding Process Explorer
3. Using Process Explorer to Troubleshoot and Diagnose
4. Understanding Process Monitor
5. Using Process Monitor to Troubleshoot and Find Registry Hacks
6. Using Autoruns to Deal with Startup Processes and Malware
7. Using BgInfo to Display System Information on the Desktop
8. Using PsTools to Control Other PCs from the Command Line
9. Analyzing and Managing Your Files, Folders, and Drives
10. Wrapping Up and Using the Tools Together

I know it is a lot of work but it is great stuff and I should create deliverables, I will eventually.

### Network Hunting
If malware is on your network, it is going to try to talk out. There are plenty of ways to look at network traffic but I recommend the tool Glasswire and Wireshark for this purpose. Glasswire identifies processes making network connections and alerts on them. If the process doesn't make sense when it pops up, go to Wireshark and open up the stream to see if it makes sense.

Tasks:
1. Download Glasswire
2. You already should have Wireshark downloaded. If not, download it.
3. Look at the Glasswire alerts. 
4. Choose one of the alerts for something that isn't a webbrowser and identify the stream in Wireshark.
5. Submit a screenshot of the data from Wireshark.

# You got tricked!

Alright so your computer is clean, probably, after following the last steps, now if you get infected in the future the most likely scenario is that you ran someone else's code and gave them access to your computer. There's nothing to feel bad about, this could have happened in many ways, and it happens to the best of us. Common ways this could have occured are online installers, phishing, and downloaded tools getting a malicious update. We will go over each method, and how to avoid it in the future. 

## Downloaded Something Nasty

Downloading something nasty is the easiest way to do this, whether it is from an email, a big green download arrow on a website, or a program from a torrent site. Phishing is the most common, because it is the most targeted, which results in a higher install rate.

One of the biggest things you can do to avoid getting phished is to learn what a phishing attempt looks like. Read this: https://blog.malwarebytes.com/101/2017/06/somethings-phishy-how-to-detect-phishing-attempts/
Also, read this: https://ssd.eff.org/en/module/how-avoid-phishing-attacks

Now what do you do if someone tries to phish you, or you are wondering if this is a phishing attempt? Read this: https://decentsecurity.com/malware-web-and-phishing-investigation/

If you get a phish, good chance other people are getting it as well. So you need to report it! Make sure you know how to report to your organization to protect everyone else!

You could have also run some backdoored shit, whether from an online download, or packaged in with real software. A good move before downloading anything is run it through these sites listed in the anti-phishing tools. These sites are pretty awesome and use a lot of cool technology to make a determination if something is malicious. 

Attachment and file checkers use something called a "sandbox" to open the file/execute the program. The sandbox monitors the process created and looks for any malicious behavior, in addition to running anti-virus looking for a known bad. 

URL checkers use a browser to visit the URL and look for malicious behavior, like attempts at infection using an exploit. They also usually provide historical information about the website and if it has been used to host malware before.

IP Checkers look at historical data for an IP address or block of IP addresses to see if they have been used for shady things in the past. Remember the difference between and IP and a URL?

Tasks: 
1. Write a few sentences on why a URL could be clean historically but the IP address could be bad. This is going to require your understanding of hosting servers and domain names. 
2. Analyze a malicious attachment using a few of the sites. Write about some of the data it provides and what you can do with it.
3. Analyze a malicious program using a few of the sites. Write about some of the data it provides and what you can do with it.
4. Analyze a malicious URL using a few of the sites. Write about some of the data it provides and what you can do with it.
5. Analyze an IP using a few of the sites. Write about some of the data it provides and what you can do with it.
6. Read this: https://www.digitalcitizen.life/uac-why-you-should-never-turn-it-off. 
7. Turn UAC all the way up. Write what is UAC and why it protects you from malware.
8. How does malware bypass UAC, other than getting a human to enter the password? (Hint: Mitre Attack) There are a few answers, google around.

##  Outdated Extensions and Other Things You Have Granted Access To

A long time ago, you might have used a FB addon that made cool faces on your profile picture, or a Chrome calendar extension that allowed you to remember your mom's birthday. Well, now the original coders got bored and sold it to some shit ass criminals who are using it to steal your shit. At one point they were good, now they are bad, and you need to get them off your shit. Most of the time, Malwarebytes can catch extensions on your computer, or Chrome will identify them as bad. Identifying evil browswer extensions will almost always be caught by the browser developers before you realize.

However, you still gotta get the addons and permissions out of your accounts.

All of these tasks are Googleable. 

Tasks:
1. Check email for devices you have given permissions to.
2. Check email for services you have given permissions to
3. Check FB for addons
4. Check Twitter for addons
5. Check any other sites you can think of for addons.


# Someone else got Owned

Your security is only as good as your weakest link. Read these articles about some of the cooler hacks in recent memory and get an idea of what is possible and where each failure was caused by someone else getting owned.

* Home depot hack
  * https://krebsonsecurity.com/2014/02/target-hackers-broke-in-via-hvac-company/
* RSA Keys
  * https://bits.blogs.nytimes.com/2011/04/02/the-rsa-hack-how-they-did-it/
* Bit9 Hack
  * https://krebsonsecurity.com/2013/02/security-firm-bit9-hacked-used-to-spread-malware/
* NotPetya
  * https://blog.talosintelligence.com/2017/07/the-medoc-connection.html
	  

Tasks:
1. Write a few sentences about how Home Depot got owned.
2. Write a few sentences on how the RSA hack enabled all the other ownage.
3. Write a few sentences on how the Bit9 hack enabled other ownage.
4. Write a few sentences on how NotPetya was done.


# Well Shit, You Got Hacked.
## How do we fix that?

We are about to get philisophical. Remember how we were just talking about how there is straight up, NO possible way for us to know if your computer is owned? Well we are about to get into the exact same problem, but now for cleaning your computer. If you have evidence that a malicious program ran on your computer, you can never trust this computer ever again. That tiny PUP that kept changing your homepage to some chinese marketplace could have been bundled with some nation state rootkit that overwrote your computer's foundational code down at the soul of the device and you aren't going to be able to remove that malware unless you return the silicon into sand.  

However, that is very, very, very unlikely. As we have said before, you are not going to be targeted by nation states, or really anyone at all. If you get hacked, almost certainly by an untargeted attack, the malware will drop itself off, establish persistence, and then do its thing. While there have been examples in the past of standard malware going for rootkit persistence, that is significantly more difficult on modern operating systems. 99% of the time, if antivirus identifies the malware and removes it, you are good and don't have to worry about any follow on problems. Sure, that does leave room for the next 1%, so my recommendation is remove the malware, let that computer chill for a day or two if you can afford to use another, and then run the malware scan again. If you keep finding malware you have a bigger problem, but the rest of the time, you can just go back to using the computer as normal. It is no life to buy a new computer every time you mess up, and it gets expensive fast.

So with all that said, if you use your computer for nuclear launch codes, critical intellectual property, or managing the crypto wallets of your hoarded wealth in addition to casual internet surfing, don't destroy the pwned computer. Buy a new computer to do your serious business, and then clean up the old one as best you can and use the old computer to surf the web. Compartmentalization is key. 

## So how do I get it clean again? 

Can't do better than this guide. 
https://blog.malwarebytes.com/101/2015/06/10-easy-steps-to-clean-your-infected-computer/
Also, go to a clean computer and change all of your passwords immediately. Allllll of them.

## What would happen if the malware doesn't all get deleted on the first run? 

If all the malware is still there, it means that the anti-virus you're using isn't very good, or that the malware is pretty good. Maybe both. Either way, you are not good enough to go and manually delete everything you need to delete the malware yourself, so best bet is don't use the computer for a few days, then try and delete it again using your tools after their signatures get updated. Think about it this way, if a piece of malware gets by your anti-virus' signatures, there is a good chance that it is somewhat new. If you got hacked by it in an untargeted attack, most likely many other people did as well. This will lead to the anti-virus company identifying the malware as persistent and then analyzing it to identify what it is missing in the first clean. Then they will update the signatures and have a more effective removal process the next time. If the malware's persistence mechanism is so good you, Windows, and Malwarebytes still can't beat it, your best move is to reinstall the operating system. This will work in most cases, though there is a small chance of a rootkit/bookit or worse, firmware malware persisting across OS installs. If this happens... get your computer to someone who can get it to the NSA because that's some high quality shit. They'll probably give you a sticker or something. 

## Repeat Attack Vectors

If you removed the malware, but you keep getting new malware a week or two later, and you are confident it isn't persistent, you need to figure out how you keep getting hit. 
* Patching
     * If you haven't patched, you are still vulnerable! You should have auto update on.
* Attachments
     * If you, or someone else keeps getting hit with attachments/etc, they need some user training
* Pirated Software
     * If you keep downloading pirated shit, you will keep getting popped. That is just how it goes.
* Porn Popups 
     * Same shit, stop going on sketchy porn sites and downloading things.
* It could be persistent and just sleeps for a week upon install
     * Reinstall your OS
     
# Securing Your Windows Box

Read Taylor Swift's Securing Your Computer List: [https://decentsecurity.com/securing-your-computer/](https://decentsecurity.com/securing-your-computer/)

Yes, that is Taylor Swift. It's complicated, but she's an amazing Windows admin in her spare time and an absolute Twitter must follow. [https://twitter.com/SwiftOnSecurity/](https://twitter.com/SwiftOnSecurity/)

Task: 
1. Complete Taylor Swift's Securing Your Computer List. Skip Section A. 
2. For each step, write a sentence or two on what that protects from, what security controls are being added, and any problems you had doing it. Turn it into your explanation of her guide. This is going to take a very long time, but it is worth it. You will learn a lot.

